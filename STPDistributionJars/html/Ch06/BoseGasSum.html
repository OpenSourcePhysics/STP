<!DOCTYPE html>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script type="text/javascript">
MathJax.Hub.Config({
    showProcessingMessages: false,
    messageStyle: "none",
    TeX: { equationNumbers: {autoNumber: "all"} },
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['',''] ],
      displayMath: [ ['',''] ],
      processEscapes: true
    },
    SVG: { linebreaks: { automatic: true } },
    "HTML-CSS": { availableFonts: ["TeX"] }
});
</script>
<html>

<head>
  <title>BoseGasSum</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />

  </head>

<body>

  <h1 id="myTitle" style="position:fixed;">Program BoseGasSum</h1>


  <div style="position:absolute;left:30px;top:500px;">

  


<p>To explicitly include indistinguishability of bosons we use the grad canonical ensemble and treat each single
particle state as a system in equilibrium with a reservoir of all the other single 
particle states at a temperature T and chemical potential &mu;. The number of bosons and energy are given by
<p>&nbsp; &nbsp;N = &Sigma; &lt;n(&epsilon;<sub><b>n</b></sub>)&gt;,&nbsp; &nbsp; (1)
<p>&nbsp; &nbsp;E = &Sigma; &epsilon;<sub><b>n</b></sub>&lt;n(&epsilon;<sub><b>n</b></sub>)&gt;, &nbsp; &nbsp;  (2)
<p>where the sums are over the single particle states &epsilon;<sub><b>n</b></sub>, and   
<p>&nbsp; &nbsp;  &lt;n(&epsilon;<sub><b>n</b></sub>)&gt; 
= 1/[exp(&epsilon;<sub><b>n</b></sub> -&mu;)/kT) - 1]  &nbsp; &nbsp;  (3) 
<p>where &lt;n(&epsilon;<sub><b>n</b></sub>)&gt;  is the mean number of bosons in a single 
particle microstate state of energy &epsilon;<sub><b>n</b></sub> = A[(n<sub>x</sub>)<sup>2</sup> 
+ (n<sub>y</sub>)<sup>2</sup>+(n<sub>z</sub>)<sup>2</sup>]. 
The integers n<sub>x</sub>, n<sub>y</sub>, and n<sub>z</sub> 
can take on any positive nonzero value and A is a constant that depends on the mass of the boson and the volume of the system.</p>

<p> For a given value of N and each value of T the program numerically determines the value of &mu; that satisfies Eq. (1), 
and then uses Eq. (2) 
to find the energy and the specific heat c = (1/N)&Delta;E/&Delta;T as a function of T.  </p>

<h2>Problem: The ideal Bose gas for a finite number of particles</h2>

Our discussion of Bose condensation has involved some subtle issues associated with the chemical potential 
and the limit of an infinite system. It is instructive to consider the ideal Bose gas 
for a finite number of particles and see how Bose condensation arises as the number of particles is increased.
(This problem is based on a paper by Price and Swendsen.) 
The idea is to start with the expressions for a finite system

<p>&nbsp; &nbsp;N(T, &mu;)  = &Sigma;<sub><b>n</b></sub> 1/[exp(&beta;(&epsilon;<sub><b>n</b></sub>-&mu;)) - 1] &nbsp; &nbsp; (4)
<p>&nbsp; &nbsp;E(T, &mu;)  = &Sigma;<sub><b>n</b></sub> &epsilon;<sub><b>n</b></sub> 1/[exp({&beta;(&epsilon;<sub><b>n</b></sub>-&mu;)) - 1], &nbsp; &nbsp; (5)

<p>and do the sums over <b>n</b> = (n<sub>x</sub>, n<sub>y</sub>, n<sub>z</sub>). We write &epsilon;<sub><b>n</b></sub> = 
A[(n<sub>x</sub>)<sup>2</sup> 
+ (n<sub>y</sub>)<sup>2</sup>+(n<sub>z</sub>)<sup>2</sup>], 
where A = (h/2&pi;)<sup>2</sup> &pi;<sup>2</sup> /2mL<sup>2</sup>. For simplicity, choose units such that A=1.

<ol type ="a">

<li> Explain why the value of T<sub>c</sub> depends on A and N.

<li>  Write a program to do the sums in Eq. (1) as three nested loops 
over n<sub>x</sub>, n<sub>y</sub>, and n<sub>z</sub>. Because &lt;n(&epsilon;)&gt; goes to zero rapidly 
for large &epsilon;, restrict the sums to values of <b>n</b> for which &lt;n(&epsilon;)&gt; &gt; &delta; 
with &delta; = 10<sup>-8</sup>. Take (n<sub>x</sub>)<sup>2</sup> 
+ (n<sub>y</sub>)<sup>2</sup>+(n<sub>z</sub>)<sup>2</sup> &lt; M, where

<p>&nbsp; &nbsp;1 / [exp(&beta; (AM - &mu;)) - 1] = &delta;,&nbsp; &nbsp; (6)

<p>or

<p>&nbsp; &nbsp;M = ln(1/&delta;  + 1)/&beta;A + &mu;/A. &nbsp; &nbsp; (7)

<p>Determine M from Eq, (7) and calculate the upper limits on the nested sums successively 
as (n<sub>x</sub>)<sup>2</sup> &lt; M, (n<sub>y</sub>)<sup>2</sup> &lt; M - (n<sub>x</sub>)<sup>2</sup>, 
and (n<sub>z</sub>)<sup>2</sup> &lt; M - (n<sub>x</sub>)<sup>2</sup> - (n<sub>y</sub>)<sup>2</sup>. 
However, your program will run reasonably quickly if you choose M as the upper limit for all three loops.

<li>  Compute N(T, &mu;) for values of &mu; between 1.0 and 7.0 for T=1.0. 
Note the divergence of N at &mu;= 3 A (the lowest single-particle energy state) and the 
negative values of N that can occur for &mu; &ge; 3A. Are there other values of &mu; where N diverges? 
Why does this nonphysical behavior of N(T, &mu;) occur?

<li>  Use your results for N(T,&mu;) to determine &mu;(N,T) by successively halving the interval 
containing the correct value of &mu; until N<sub>trial</sub> is close to the desired value. 
Choose the initial upper and lower limits of the interval to be &mu;<sub>+</sub> =&epsilon;<sub>0</sub> = 3A 
and &mu;<sub>-</sub> = -10&epsilon;<sub>0</sub>. 
A summary of the algorithm is given by the following:

<ol>

<li> Set &mu;<sub>trial</sub> = (1/2)(&mu;<sub>+</sub> + &mu;<sub>-</sub>).</li>

<li>Compute N<sub>trial</sub> = N(&mu;<sub>trial</sub>,T)</li>

<li>If N<sub>trial</sub> &gt; N, set &mu;<sub>+</sub> = &mu;<sub>trial</sub>; otherwise, set &mu;<sub>-</sub> = &mu;<sub>trial</sub>.</li>

<li>If &mu;<sub>+</sub> - &mu;<sub>-</sub> &gt; &Delta;&mu;, go to step 1.</li>
</ol>
First choose N=5 to check that your program is working correctly and then consider N = 500.

<li>  Use the results from part(d) to plot &mu; as a function of T/T<sub>c</sub> for N=500 and 
describe its qualitative behavior. (In your program include code to find T<sub>c</sub> using the answer 
to part(a).) What is the upper limit of &mu;?

<li>  Plot the fraction of particles in the two lowest energy states as a function of T. 
Discuss their behavior as a function of temperature.

<li>  Although it is instructive to write your own program, 
Program  <tt>BoseGasSum</tt> implements the sum over <b>n</b> and computes &mu; by varying its value until the 
computed N equals the desired input value. The program plots &lt;N<sub>0</sub>&gt;, &lt;N<sub>ex</sub>&gt; = N-&lt;N<sub>0</sub>&gt;
and the specific heat C = (1/N)&Delta;E/&Delta;T by using two neighboring values of the temperature.
Use the default values and explain why there appears to be a phase transition. How does the value of the transition 
temperature depend on the difference between the ground state and the first excited state? 
Does the transition temperature become better defined as N is increased?


</ol>


  <h2>Resources</h2>
  <ol>

 <li><a href="https://www.compadre.org/OSP/document/ServeFile.cfm?ID=15436&DocID=5284&Attachment=1">Download</a> 
    source code for all java programs. Requires <a href="https://github.com/OpenSourcePhysics/osp">OSP</a> library to run.</li>
    
    <li><a href="https://www.compadre.org/OSP/document/ServeFile.cfm?ID=15436&DocID=5285&Attachment=1">Download</a> all python programs. </li>
    <li><a href="https://www.compadre.org/osp/items/detail.cfm?ID=7308">Download</a> latest executable jar file for all programs. </li>
    
    <li>Problem 6.67 in <i>Statistical and Thermal Physics: With Computer Applications,</i> 2nd ed., 
    Harvey Gould and Jan Tobochnik, Princeton University Press (2021).</li>   

 <li>T. Price and R. H. Swendsen, &#8220;
            <a href="http://dx.doi.org/10.1119/1.4822174">Numerical computation for teaching quantum statistics</a>,&#8221; Am. J. Phys. <b>81</b>, 866&#8211;872 (2013).</li>


</ol>

 
  <p class="small">Updated 21 August 2020.</p>
</div>

</body>

</html>